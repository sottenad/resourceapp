<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/main.css">

    <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.1.min.js"><\/script>')</script>
    <script src="js/vendor/jquery-ui-1.10.4.custom.min.js"></script>

	<!--Start Libraries-->    
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.14/angular.min.js"></script>
    <script src='https://cdn.firebase.com/v0/firebase.js'></script>
    <script src='https://cdn.firebase.com/libs/angularfire/0.7.0/angularfire.min.js'></script>
    <script>
    	$(function(){
    		jQuery.event.props.push('dataTransfer');
    	})
    </script>

</head>
<body ng-app="resourcing">

	<nav class="navbar navbar-default" role="navigation">
	  <div class="container-fluid">
	    <!-- Brand and toggle get grouped for better mobile display -->
	    <div class="navbar-header">
	      <a class="navbar-brand" href="#">Resourcing</a>
	    </div>
	

	      
	    </div><!-- /.navbar-collapse -->
	  </div><!-- /.container-fluid -->
	</nav>
	<!-- End Nav-->

	<!--Show People-->
    	<div class="col-xs-3 people" ng-controller="peopleCtrl">
    		<span class="glyphicon glyphicon-cog editbtn" ng-click="toggleEdit()"></span>
    		<h3>
    			People 
    			<a class="btn btn-default btn-xs" data-toggle="modal" data-target="#addPersonModal">Add</a>
    		</h3>
    		<span>{{peopleCount()}}</span>
    		<table class="table">
			<tr ng-model="person" ng-repeat="(key, person) in people" x-lvl-draggable='true' data-key="{{key}}"  ng-class="{danger: totalAllocation(key)>100, success: 80<totalAllocation(key) && totalAllocation(key) <=100}">
    			<td class="first">
    			<span class="glyphicon glyphicon-ban-circle" ng-click="removePerson(key)" ng-if="editPeople"></span>
				<span class="person">{{person.firstName}} {{person.lastName}}</span>
    			</td>
    			<td>
				<span>{{totalAllocation(key)}}</span>
    			</td>
			</tr>
    		</table>
    	</div>
    	<div class="col-xs-9 projectContainer" ng-controller="projectCtrl">
    		<h3>Projects <a class="btn btn-default btn-xs" data-toggle="modal" data-target="#addProjectModal">Add</a></h3>
    		<span class="glyphicon glyphicon-cog editbtn" ng-click="editProjects=!editProjects"></span>

    		<div class="row">
    			<div ng-repeat="(key,project) in projects" class=" droptarget project" data-key="{{key}}" x-lvl-drop-target='true' x-on-drop="addPersonToProject(dragEl, dropEl)">
	        		<span class="status {{project.status.toLowerCase()}}"></span>
	    			<span ng-if="editProjects" class="glyphicon glyphicon-ban-circle deleteProject" ng-click="removeProject(key)"></span>
    				<div class="col-md-4">
    				<h3 ng-click="setProjectToEdit(key)">{{project.name}}</h3>
    				<small>{{formatPrice(project.budget)}}</small>
    				</div>
	    			<div class="col-md-7">
		    			<div ng-repeat="(personKey,person) in project.people" data-key="{{personKey}}" class="allocation" >
	    					{{people[personKey].firstName}} {{people[personKey].lastName}} (<span>{{project.people[personKey].allocation}}</span>%)
	    					<span class="glyphicon glyphicon-ban-circle" ng-click="removePersonFromProject(personKey,key)"></span>
	    					<input type="range" min="0" max="100" step="10" ng-change="setPersonsAllocation(personKey, key)" ng-model="project.people[personKey].allocation" />
	    					
		    			</div>
	    			</div>
    			</div>
    		</div>
    	</div>




<!--=============================================-->    	
    <div class="modal fade" id="addPersonModal" ng-controller="peopleCtrl">
	  <div class="modal-dialog modal-sm">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">Add Person</h4>
	      </div>
	      <div class="modal-body">
    	    <form>
    	    	<div class="form-group">
	    	    	<label>First Name</label>
		    		<input type="text" ng-model="person.firstName" placeholder="First Name" class="form-control" autofocus/>
    	    	</div>
	    		<div class="form-group">
		    		<label>Last Name</label>
		    		<input type="text" ng-model="person.lastName" placeholder="Last Name" class="form-control"/>
	    		</div>
	    		<div class="form-group">
	    			<label>Role</label>
		    		<select ng-model="person.type" class="form-control">
		    			<option ng-repeat="type in peopleTypes | orderBy:type" value="{{type}}">{{type}}</option>
		    		</select>
	    		</div>
    		</form>
	      </div>
	      <div class="modal-footer">
		    <button class="btn btn-primary" data-dismiss="modal" ng-click="addPerson()">Add Person</button>
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal --> 
<!--=============================================-->
	<!--Add Project-->
    <div class="modal fade" id="addProjectModal" ng-controller="projectCtrl">
	  <div class="modal-dialog modal-sm">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">Add Project</h4>
	      </div>
	      <div class="modal-body">
    	    <form>
    	    	<div class="form-group">
	    	    	<label>Project Name</label>
		    		<input type="text" ng-model="project.name" placeholder="Client Name" class="form-control" autofocus/>
    	    	</div>
	    		<div class="form-group">
		    		<label>Project Budget <small>($USD)</small></label>
		    		<input type="number" ng-model="project.budget" placeholder="105000" class="form-control"/>
	    		</div>
    		</form>
	      </div>
	      <div class="modal-footer">
		    <button class="btn btn-primary" data-dismiss="modal" ng-click="addProject()">Add Project</button>
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal --> 
<!--=============================================-->	
	<!--Edit Project-->
    <div class="modal fade" id="editProjectModal" ng-controller="projectCtrl">
	  <div class="modal-dialog modal-sm">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title">Edit Project</h4>
	      </div>
	      <div class="modal-body">
    	    <form>
    	    	<div class="form-group">
	    	    	<label>Project Name</label>
		    		<input type="text" ng-model="projectToEdit.name" placeholder="Client Name" class="form-control" autofocus/>
    	    	</div>
	    		<div class="form-group">
		    		<label>Project Budget <small>($USD)</small></label>
		    		<input type="number" ng-model="projectToEdit.budget" placeholder="105000" class="form-control"/>
	    		</div>
	    		<div class="form-group">
	    			<label>State</label>
		    		<select ng-model="projectToEdit.status" class="form-control">
		    			<option ng-repeat="val in projectStates | orderBy:type" value="{{val}}">{{val}}</option>
		    		</select>
	    		</div>
    		</form>
	      </div>
	      <div class="modal-footer">
		    <button class="btn btn-primary" data-dismiss="modal" ng-click="updateProject(projectToEdit.$id)">Save Project</button>
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal --> 
<!--=============================================-->
        
    
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    <!--Start App-->
    <script src="js/vendor/uuid.js"></script>   
    <script src="js/vendor/drag-drop.js"></script>
    
    <script src="js/app.js"></script>
    <script src="js/people.js"></script>
    <script src="js/factories/people.js"></script>
    <script src="js/factories/project.js"></script>
    <script src="js/projects.js"></script>
    

    <script>
        var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src='//www.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    
</body>
</html>
